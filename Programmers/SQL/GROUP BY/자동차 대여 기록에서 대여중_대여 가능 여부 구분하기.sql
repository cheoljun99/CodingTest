-- 코드를 입력하세요

SELECT B.CAR_ID, CASE WHEN AVAILABILITYCHECK = 0 THEN '대여 가능' ELSE '대여중' END AS AVAILABILITY
FROM(
SELECT A.CAR_ID, SUM(A.AVAILABILITY) AS AVAILABILITYCHECK
FROM (SELECT CAR_ID ,CASE WHEN
END_DATE<'2022-10-16 00:00:00' AND START_DATE <'2022-10-16 00:00:00' THEN 0
ELSE 1
END AS AVAILABILITY
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE START_DATE <='2022-10-16 00:00:00'
ORDER BY CAR_id) A
GROUP BY CAR_ID
)  B
ORDER BY  B.CAR_ID DESC